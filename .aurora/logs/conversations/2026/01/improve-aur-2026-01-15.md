# SOAR Conversation Log

**Query ID**: soar-1768485013860
**Timestamp**: 2026-01-15T14:54:52.299145
**User Query**: how do i improve aur soar parallel agent spawning that keeps on failing with adhoc agents?

---

## Execution Summary

- **Duration**: 278436.94376945496ms
- **Overall Score**: 0.90
- **Cached**: True
- **Cost**: $0.0175
- **Tokens Used**: 45 input + 1159 output

## Metadata

```json
{
  "query_id": "soar-1768485013860",
  "query": "how do i improve aur soar parallel agent spawning that keeps on failing with adhoc agents?",
  "total_duration_ms": 278436.94376945496,
  "total_cost_usd": 0.01752,
  "tokens_used": {
    "input": 45,
    "output": 1159
  },
  "budget_status": {
    "period": "2026-01",
    "limit_usd": 10.0,
    "consumed_usd": 0.7155029999999999,
    "remaining_usd": 9.284497,
    "percent_consumed": 7.155029999999998,
    "at_soft_limit": false,
    "at_hard_limit": false,
    "total_entries": 234
  },
  "phases": {
    "phase1_assess": {
      "complexity": "COMPLEX",
      "confidence": 0.5266666666666666,
      "method": "keyword",
      "reasoning": "Multi-dimensional keyword analysis: complex complexity",
      "score": 0.6,
      "_timing_ms": 34.55209732055664,
      "_error": null
    },
    "phase2_retrieve": {
      "code_chunks": [
        {
          "chunk_id": "enhance-agent-2026-01-15_section_0_5e75250532df6d84",
          "content": "# SOAR Conversation Log\n\n**Query ID**: soar-1768460218715\n**Timestamp**: 2026-01-15T08:44:09.912651\n**User Query**: how do i enhance agent recovery for aur soar to detect it early without waiting\n\n---",
          "bm25_score": 0.6801942899947052,
          "activation_score": 0.0,
          "semantic_score": 1.0,
          "hybrid_score": 0.6040582869984116,
          "metadata": {
            "type": "kb",
            "name": "Introduction",
            "file_path": "/home/hamr/PycharmProjects/aurora/.aurora/logs/conversations/2026/01/enhance-agent-2026-01-15.md",
            "line_start": 1,
            "line_end": 7,
            "access_count": 0
          }
        },
        {
          "chunk_id": "enhance-agent-2026-01-15-8_section_0_9740db2c02bfba03",
          "content": "# SOAR Conversation Log\n\n**Query ID**: soar-1768474039622\n**Timestamp**: 2026-01-15T11:47:42.141363\n**User Query**: how do i enhance agent recovery for aur soar to detect it early without waiting\n\n---",
          "bm25_score": 0.6801942899947052,
          "activation_score": 0.0,
          "semantic_score": 0.9993459253677321,
          "hybrid_score": 0.6037966571455045,
          "metadata": {
            "type": "kb",
            "name": "Introduction",
            "file_path": "/home/hamr/PycharmProjects/aurora/.aurora/logs/conversations/2026/01/enhance-agent-2026-01-15-8.md",
            "line_start": 1,
            "line_end": 7,
            "access_count": 0
          }
        },
        {
          "chunk_id": "enhance-agent-2026-01-15-10_section_0_8e25533b0b399e29",
          "content": "# SOAR Conversation Log\n\n**Query ID**: soar-1768475569761\n**Timestamp**: 2026-01-15T12:14:17.827073\n**User Query**: how do i enhance agent recovery for aur soar to detect it early without waiting\n\n---",
          "bm25_score": 0.6801942899947052,
          "activation_score": 0.0,
          "semantic_score": 0.9971075873149182,
          "hybrid_score": 0.6029013219243788,
          "metadata": {
            "type": "kb",
            "name": "Introduction",
            "file_path": "/home/hamr/PycharmProjects/aurora/.aurora/logs/conversations/2026/01/enhance-agent-2026-01-15-10.md",
            "line_start": 1,
            "line_end": 7,
            "access_count": 0
          }
        },
        {
          "chunk_id": "enhance-agent-2026-01-15-16_section_0_13d0c795494d961b",
          "content": "# SOAR Conversation Log\n\n**Query ID**: soar-1768478037105\n**Timestamp**: 2026-01-15T12:57:00.083939\n**User Query**: how do i enhance agent recovery for aur soar to detect it early without waiting\n\n---",
          "bm25_score": 0.6801942899947052,
          "activation_score": 0.0,
          "semantic_score": 0.9957633983670702,
          "hybrid_score": 0.6023636463452396,
          "metadata": {
            "type": "kb",
            "name": "Introduction",
            "file_path": "/home/hamr/PycharmProjects/aurora/.aurora/logs/conversations/2026/01/enhance-agent-2026-01-15-16.md",
            "line_start": 1,
            "line_end": 7,
            "access_count": 0
          }
        },
        {
          "chunk_id": "enhance-agent-2026-01-15-6_section_0_2ba9a79a71340902",
          "content": "# SOAR Conversation Log\n\n**Query ID**: soar-1768473875524\n**Timestamp**: 2026-01-15T11:44:44.546132\n**User Query**: how do i enhance agent recovery for aur soar to detect it early without waiting\n\n---",
          "bm25_score": 0.6801942899947052,
          "activation_score": 0.0,
          "semantic_score": 0.9954864858636445,
          "hybrid_score": 0.6022528813438695,
          "metadata": {
            "type": "kb",
            "name": "Introduction",
            "file_path": "/home/hamr/PycharmProjects/aurora/.aurora/logs/conversations/2026/01/enhance-agent-2026-01-15-6.md",
            "line_start": 1,
            "line_end": 7,
            "access_count": 0
          }
        },
        {
          "chunk_id": "enhance-agent-2026-01-15-7_section_0_48d005fa32cca2f4",
          "content": "# SOAR Conversation Log\n\n**Query ID**: soar-1768473981426\n**Timestamp**: 2026-01-15T11:46:31.288989\n**User Query**: how do i enhance agent recovery for aur soar to detect it early without waiting\n\n---",
          "bm25_score": 0.6801942899947052,
          "activation_score": 0.0,
          "semantic_score": 0.9942219035580498,
          "hybrid_score": 0.6017470484216315,
          "metadata": {
            "type": "kb",
            "name": "Introduction",
            "file_path": "/home/hamr/PycharmProjects/aurora/.aurora/logs/conversations/2026/01/enhance-agent-2026-01-15-7.md",
            "line_start": 1,
            "line_end": 7,
            "access_count": 0
          }
        },
        {
          "chunk_id": "enhance-agent-2026-01-15-3_section_0_863d284c8f10559d",
          "content": "# SOAR Conversation Log\n\n**Query ID**: soar-1768473344102\n**Timestamp**: 2026-01-15T11:35:54.396666\n**User Query**: how do i enhance agent recovery for aur soar to detect it early without waiting\n\n---",
          "bm25_score": 0.6801942899947052,
          "activation_score": 0.0,
          "semantic_score": 0.9940293877813684,
          "hybrid_score": 0.6016700421109589,
          "metadata": {
            "type": "kb",
            "name": "Introduction",
            "file_path": "/home/hamr/PycharmProjects/aurora/.aurora/logs/conversations/2026/01/enhance-agent-2026-01-15-3.md",
            "line_start": 1,
            "line_end": 7,
            "access_count": 0
          }
        },
        {
          "chunk_id": "enhance-agent-2026-01-15-9_section_0_518cb6275e151000",
          "content": "# SOAR Conversation Log\n\n**Query ID**: soar-1768474896707\n**Timestamp**: 2026-01-15T12:03:56.232215\n**User Query**: how do i enhance agent recovery for aur soar to detect it early without waiting\n\n---",
          "bm25_score": 0.6801942899947052,
          "activation_score": 0.0,
          "semantic_score": 0.9922218151838422,
          "hybrid_score": 0.6009470130719485,
          "metadata": {
            "type": "kb",
            "name": "Introduction",
            "file_path": "/home/hamr/PycharmProjects/aurora/.aurora/logs/conversations/2026/01/enhance-agent-2026-01-15-9.md",
            "line_start": 1,
            "line_end": 7,
            "access_count": 0
          }
        },
        {
          "chunk_id": "enhance-agent-2026-01-15-5_section_0_e76a4e9838daf7ba",
          "content": "# SOAR Conversation Log\n\n**Query ID**: soar-1768473816480\n**Timestamp**: 2026-01-15T11:44:01.384000\n**User Query**: how do i enhance agent recovery for aur soar to detect it early without waiting\n\n---",
          "bm25_score": 0.6801942899947052,
          "activation_score": 0.0,
          "semantic_score": 0.9918197902354997,
          "hybrid_score": 0.6007862030926114,
          "metadata": {
            "type": "kb",
            "name": "Introduction",
            "file_path": "/home/hamr/PycharmProjects/aurora/.aurora/logs/conversations/2026/01/enhance-agent-2026-01-15-5.md",
            "line_start": 1,
            "line_end": 7,
            "access_count": 0
          }
        },
        {
          "chunk_id": "enhance-agent-2026-01-15-12_section_0_920f796a480dbd40",
          "content": "# SOAR Conversation Log\n\n**Query ID**: soar-1768475909060\n**Timestamp**: 2026-01-15T12:20:19.491934\n**User Query**: how do i enhance agent recovery for aur soar to detect it early without waiting\n\n---",
          "bm25_score": 0.6801942899947052,
          "activation_score": 0.0,
          "semantic_score": 0.9914575686082839,
          "hybrid_score": 0.6006413144417251,
          "metadata": {
            "type": "kb",
            "name": "Introduction",
            "file_path": "/home/hamr/PycharmProjects/aurora/.aurora/logs/conversations/2026/01/enhance-agent-2026-01-15-12.md",
            "line_start": 1,
            "line_end": 7,
            "access_count": 0
          }
        },
        {
          "chunk_id": "enhance-agent-2026-01-15-17_section_0_66b6cc3ad7d4578e",
          "content": "# SOAR Conversation Log\n\n**Query ID**: soar-1768478841600\n**Timestamp**: 2026-01-15T13:07:32.927953\n**User Query**: how do i enhance agent recovery for aur soar to detect it early without waiting\n\n---",
          "bm25_score": 0.6801942899947052,
          "activation_score": 0.0,
          "semantic_score": 0.99051255336801,
          "hybrid_score": 0.6002633083456156,
          "metadata": {
            "type": "kb",
            "name": "Introduction",
            "file_path": "/home/hamr/PycharmProjects/aurora/.aurora/logs/conversations/2026/01/enhance-agent-2026-01-15-17.md",
            "line_start": 1,
            "line_end": 7,
            "access_count": 0
          }
        },
        {
          "chunk_id": "enhance-agent-2026-01-15-4_section_0_08d488458557ac4b",
          "content": "# SOAR Conversation Log\n\n**Query ID**: soar-1768473399875\n**Timestamp**: 2026-01-15T11:36:50.130444\n**User Query**: how do i enhance agent recovery for aur soar to detect it early without waiting\n\n---",
          "bm25_score": 0.6801942899947052,
          "activation_score": 0.0,
          "semantic_score": 0.9874843075727223,
          "hybrid_score": 0.5990520100275005,
          "metadata": {
            "type": "kb",
            "name": "Introduction",
            "file_path": "/home/hamr/PycharmProjects/aurora/.aurora/logs/conversations/2026/01/enhance-agent-2026-01-15-4.md",
            "line_start": 1,
            "line_end": 7,
            "access_count": 0
          }
        },
        {
          "chunk_id": "enhance-agent-2026-01-15-14_section_0_0977f89c9daf65a1",
          "content": "# SOAR Conversation Log\n\n**Query ID**: soar-1768476215407\n**Timestamp**: 2026-01-15T12:25:47.173596\n**User Query**: how do i enhance agent recovery for aur soar to detect it early without waiting\n\n---",
          "bm25_score": 0.6801942899947052,
          "activation_score": 0.0,
          "semantic_score": 0.9873761885227851,
          "hybrid_score": 0.5990087624075255,
          "metadata": {
            "type": "kb",
            "name": "Introduction",
            "file_path": "/home/hamr/PycharmProjects/aurora/.aurora/logs/conversations/2026/01/enhance-agent-2026-01-15-14.md",
            "line_start": 1,
            "line_end": 7,
            "access_count": 0
          }
        },
        {
          "chunk_id": "enhance-agent-2026-01-15-13_section_0_3cb959a53d4b2fe5",
          "content": "# SOAR Conversation Log\n\n**Query ID**: soar-1768476108848\n**Timestamp**: 2026-01-15T12:23:05.483344\n**User Query**: how do i enhance agent recovery for aur soar to detect it early without waiting\n\n---",
          "bm25_score": 0.6801942899947052,
          "activation_score": 0.0,
          "semantic_score": 0.98734904471067,
          "hybrid_score": 0.5989979048826796,
          "metadata": {
            "type": "kb",
            "name": "Introduction",
            "file_path": "/home/hamr/PycharmProjects/aurora/.aurora/logs/conversations/2026/01/enhance-agent-2026-01-15-13.md",
            "line_start": 1,
            "line_end": 7,
            "access_count": 0
          }
        },
        {
          "chunk_id": "enhance-agent-2026-01-15-18_section_0_54e699967d843c35",
          "content": "# SOAR Conversation Log\n\n**Query ID**: soar-1768478875924\n**Timestamp**: 2026-01-15T13:08:07.426297\n**User Query**: how do i enhance agent recovery for aur soar to detect it early without waiting\n\n---",
          "bm25_score": 0.6801942899947052,
          "activation_score": 0.0,
          "semantic_score": 0.9863516806898885,
          "hybrid_score": 0.598598959274367,
          "metadata": {
            "type": "kb",
            "name": "Introduction",
            "file_path": "/home/hamr/PycharmProjects/aurora/.aurora/logs/conversations/2026/01/enhance-agent-2026-01-15-18.md",
            "line_start": 1,
            "line_end": 7,
            "access_count": 0
          }
        }
      ],
      "reasoning_chunks": [],
      "total_retrieved": 15,
      "chunks_retrieved": 15,
      "high_quality_count": 0,
      "retrieval_time_ms": 7375.274419784546,
      "budget": 15,
      "budget_used": 15,
      "_timing_ms": 7375.548601150513,
      "_error": null
    },
    "phase3_decompose": {
      "decomposition": {
        "goal": "Diagnose and fix parallel agent spawning failures in aur soar with adhoc agents",
        "subgoals": [
          {
            "description": "Analyze spawner logs and error patterns to identify root cause of adhoc agent failures",
            "ideal_agent": "devops-engineer",
            "ideal_agent_desc": "Specialist in infrastructure, process management, and debugging distributed systems",
            "assigned_agent": "full-stack-dev",
            "match_quality": "acceptable",
            "is_critical": true,
            "depends_on": []
          },
          {
            "description": "Review spawner circuit breaker and timeout policy implementations for edge cases",
            "ideal_agent": "reliability-engineer",
            "ideal_agent_desc": "Expert in fault tolerance, circuit breakers, and resilience patterns",
            "assigned_agent": "full-stack-dev",
            "match_quality": "acceptable",
            "is_critical": true,
            "depends_on": []
          },
          {
            "description": "Examine early detection mechanism and observability instrumentation for gaps",
            "ideal_agent": "observability-engineer",
            "ideal_agent_desc": "Specialist in monitoring, metrics, tracing, and early failure detection",
            "assigned_agent": "full-stack-dev",
            "match_quality": "acceptable",
            "is_critical": true,
            "depends_on": []
          },
          {
            "description": "Design improvements to spawner error handling and recovery for adhoc agents",
            "ideal_agent": "reliability-engineer",
            "ideal_agent_desc": "Expert in designing fault-tolerant distributed systems with graceful degradation",
            "assigned_agent": "holistic-architect",
            "match_quality": "excellent",
            "is_critical": true,
            "depends_on": [
              0,
              1,
              2
            ]
          },
          {
            "description": "Implement enhanced circuit breaker logic with adhoc-specific failure detection",
            "ideal_agent": "backend-engineer",
            "ideal_agent_desc": "Developer specialized in backend services, async processing, and error handling",
            "assigned_agent": "full-stack-dev",
            "match_quality": "excellent",
            "is_critical": true,
            "depends_on": [
              3
            ]
          },
          {
            "description": "Add proactive health checks and early failure signals to spawner observability",
            "ideal_agent": "observability-engineer",
            "ideal_agent_desc": "Expert in metrics, alerting, and proactive monitoring patterns",
            "assigned_agent": "full-stack-dev",
            "match_quality": "acceptable",
            "is_critical": true,
            "depends_on": [
              3
            ]
          },
          {
            "description": "Create comprehensive test suite for parallel spawning edge cases and failure scenarios",
            "ideal_agent": "test-engineer",
            "ideal_agent_desc": "QA specialist focused on integration testing, chaos engineering, and failure injection",
            "assigned_agent": "qa-test-architect",
            "match_quality": "excellent",
            "is_critical": true,
            "depends_on": [
              4,
              5
            ]
          },
          {
            "description": "Validate fixes against real-world adhoc agent spawning scenarios with load testing",
            "ideal_agent": "performance-engineer",
            "ideal_agent_desc": "Specialist in load testing, performance validation, and concurrency testing",
            "assigned_agent": "qa-test-architect",
            "match_quality": "acceptable",
            "is_critical": false,
            "depends_on": [
              6
            ]
          }
        ],
        "execution_order": [
          {
            "phase": 1,
            "parallelizable": [
              0,
              1,
              2
            ],
            "sequential": []
          },
          {
            "phase": 2,
            "parallelizable": [
              3
            ],
            "sequential": []
          },
          {
            "phase": 3,
            "parallelizable": [
              4,
              5
            ],
            "sequential": []
          },
          {
            "phase": 4,
            "parallelizable": [
              6
            ],
            "sequential": []
          },
          {
            "phase": 5,
            "parallelizable": [
              7
            ],
            "sequential": []
          }
        ],
        "expected_tools": [
          "code_reader",
          "grep",
          "log_analyzer",
          "code_writer",
          "test_runner",
          "bash"
        ]
      },
      "cached": false,
      "query_hash": "64ac84445f9a35679a46b57393c8c3b2dbaaeb352f4760106eaf73beaab29c46",
      "timing_ms": 17211.042858005385,
      "subgoals_total": 8,
      "_timing_ms": 17214.335441589355,
      "_error": null
    },
    "phase4_verify": {
      "final_verdict": "PASS",
      "agent_assignments": [
        {
          "index": 0,
          "agent_id": "full-stack-dev"
        },
        {
          "index": 1,
          "agent_id": "full-stack-dev"
        },
        {
          "index": 2,
          "agent_id": "full-stack-dev"
        },
        {
          "index": 3,
          "agent_id": "holistic-architect"
        },
        {
          "index": 4,
          "agent_id": "full-stack-dev"
        },
        {
          "index": 5,
          "agent_id": "full-stack-dev"
        },
        {
          "index": 6,
          "agent_id": "qa-test-architect"
        },
        {
          "index": 7,
          "agent_id": "qa-test-architect"
        }
      ],
      "issues": [],
      "subgoals_detailed": [
        {
          "index": 1,
          "description": "Analyze spawner logs and error patterns to identify root cause of adhoc agent failures",
          "agent": "full-stack-dev",
          "is_critical": true,
          "depends_on": [],
          "is_spawn": false,
          "match_quality": "acceptable",
          "ideal_agent": "devops-engineer",
          "ideal_agent_desc": "Specialist in infrastructure, process management, and debugging distributed systems"
        },
        {
          "index": 2,
          "description": "Review spawner circuit breaker and timeout policy implementations for edge cases",
          "agent": "full-stack-dev",
          "is_critical": true,
          "depends_on": [],
          "is_spawn": false,
          "match_quality": "acceptable",
          "ideal_agent": "reliability-engineer",
          "ideal_agent_desc": "Expert in fault tolerance, circuit breakers, and resilience patterns"
        },
        {
          "index": 3,
          "description": "Examine early detection mechanism and observability instrumentation for gaps",
          "agent": "full-stack-dev",
          "is_critical": true,
          "depends_on": [],
          "is_spawn": false,
          "match_quality": "acceptable",
          "ideal_agent": "observability-engineer",
          "ideal_agent_desc": "Specialist in monitoring, metrics, tracing, and early failure detection"
        },
        {
          "index": 4,
          "description": "Design improvements to spawner error handling and recovery for adhoc agents",
          "agent": "holistic-architect",
          "is_critical": true,
          "depends_on": [
            0,
            1,
            2
          ],
          "is_spawn": false,
          "match_quality": "excellent",
          "ideal_agent": "",
          "ideal_agent_desc": ""
        },
        {
          "index": 5,
          "description": "Implement enhanced circuit breaker logic with adhoc-specific failure detection",
          "agent": "full-stack-dev",
          "is_critical": true,
          "depends_on": [
            3
          ],
          "is_spawn": false,
          "match_quality": "excellent",
          "ideal_agent": "",
          "ideal_agent_desc": ""
        },
        {
          "index": 6,
          "description": "Add proactive health checks and early failure signals to spawner observability",
          "agent": "full-stack-dev",
          "is_critical": true,
          "depends_on": [
            3
          ],
          "is_spawn": false,
          "match_quality": "acceptable",
          "ideal_agent": "observability-engineer",
          "ideal_agent_desc": "Expert in metrics, alerting, and proactive monitoring patterns"
        },
        {
          "index": 7,
          "description": "Create comprehensive test suite for parallel spawning edge cases and failure scenarios",
          "agent": "qa-test-architect",
          "is_critical": true,
          "depends_on": [
            4,
            5
          ],
          "is_spawn": false,
          "match_quality": "excellent",
          "ideal_agent": "",
          "ideal_agent_desc": ""
        },
        {
          "index": 8,
          "description": "Validate fixes against real-world adhoc agent spawning scenarios with load testing",
          "agent": "qa-test-architect",
          "is_critical": false,
          "depends_on": [
            6
          ],
          "is_spawn": false,
          "match_quality": "acceptable",
          "ideal_agent": "performance-engineer",
          "ideal_agent_desc": "Specialist in load testing, performance validation, and concurrency testing"
        }
      ],
      "_timing_ms": 0,
      "_error": null
    },
    "phase5_collect": {
      "agent_outputs": [],
      "execution_metadata": {
        "total_duration_ms": 180003,
        "total_subgoals": 8,
        "failed_subgoals": 0,
        "fallback_count": 0,
        "circuit_blocked": [],
        "circuit_blocked_count": 0
      },
      "user_interactions": [],
      "fallback_agents": [],
      "_timing_ms": 0,
      "_error": null,
      "agents_executed": 0,
      "recovery_metrics": {
        "total_failures": 0,
        "early_terminations": 0,
        "early_termination_details": [],
        "circuit_breaker_blocks": 0,
        "circuit_blocked_agents": [],
        "circuit_blocked_details": [],
        "timeout_count": 0,
        "timeout_agents": [],
        "rate_limit_count": 0,
        "rate_limit_agents": [],
        "auth_failure_count": 0,
        "auth_failed_agents": [],
        "fallback_used_count": 0,
        "fallback_agents": []
      }
    },
    "phase6_synthesize": {
      "answer": "Based on my analysis of the Aurora codebase, here's how to improve the parallel agent spawning failures with adhoc agents in `aur soar`:\n## Root Causes of Adhoc Agent Failures\nThe system has **multiple detection and termination mechanisms** that can cause adhoc agents to fail:\n1. **Early Detection Monitor** (packages/spawner/src/aurora_spawner/early_detection.py:77-339)\n- Checks every 5 seconds for stalled agents\n- Requires 120s without output growth AND 2 consecutive stall checks before terminating\n- Only triggers after minimum 100 bytes of output received\n2. **Proactive Health Monitor** (packages/spawner/src/aurora_spawner/observability.py)\n- Runs health checks independently\n- Tracks execution metrics and circuit breaker state\n3. **Circuit Breaker** (packages/spawner/src/aurora_spawner/circuit_breaker.py:236-265)\n- Blocks agents that have failed 3+ times\n- Causes immediate fallback to LLM without attempting execution\n- Reset timeout: 120s\n4. **Timeout Policies** (packages/spawner/src/aurora_spawner/spawner.py:337-339)\n- Default \"patient\" policy: 300s timeout, 120s no-activity timeout\n- Adhoc agents use `policy_name=\"patient\"` (collect.py:338)\n## Configuration-Based Solutions\n**Option 1: Tune early detection thresholds** (recommended for adhoc agents)\nAdd to `.aurora/config.json`:\n```json\n{\n\"soar\": {\n\"agent_timeout_seconds\": 600,\n\"early_detection\": {\n\"enabled\": true,\n\"check_interval\": 10.0,\n\"stall_threshold\": 300.0,\n\"min_output_bytes\": 200,\n\"stderr_pattern_check\": true\n}\n}\n}\n```\nThis configuration:\n- Extends timeout to 10 minutes (adhoc agents may need more time)\n- Increases check interval from 5s \u2192 10s (more patient)\n- Raises stall threshold from 120s \u2192 300s (allows longer pauses)\n- Requires 200 bytes output before stall checking (filter startup noise)\n**Option 2: Disable early detection for adhoc agents**\n```json\n{\n\"soar\": {\n\"early_detection\": {\n\"enabled\": false\n}\n}\n}\n```\n**Option 3: Use custom timeout policy**\nThe code supports configurable policies (packages/spawner/src/aurora_spawner/timeout_policy.py). For adhoc agents, you could create a \"lenient\" policy with:\n- Longer initial timeout (600s)\n- No early termination on stderr patterns\n- Higher activity check interval\n## Code-Level Improvements\n**Issue 1: Adhoc agent prompt may not signal activity properly**\nLocation: packages/soar/src/aurora_soar/phases/collect.py:302-327\nThe adhoc agent spawn uses `agent_matcher._create_spawn_prompt()` which may not instruct the LLM to emit periodic progress. The early detection monitor relies on stdout growth.\n**Recommendation**: Update the adhoc spawn prompt to include:\n```python\nprompt = f\"\"\"For this specific request, act as a {agent.id} specialist.\nTask: {subgoal.get(\"description\", \"\")}\nIMPORTANT: Emit progress updates every 30 seconds as you work.\nPlease complete this task directly...\"\"\"\n```\n**Issue 2: Circuit breaker blocks adhoc agents after first failures**\nLocation: packages/soar/src/aurora_soar/phases/collect.py:252-295\nAdhoc agents are treated like regular agents for circuit breaker purposes. If an adhoc agent fails 3 times, it's blocked for 120s. But adhoc agents don't have established reliability.\n**Recommendation**: Skip circuit breaker for adhoc agents:\n```python\n# In collect.py, line 253\nif agent.id != \"llm\" and not is_spawn:  # Skip circuit check for adhoc\nshould_skip, skip_reason = circuit_breaker.should_skip(agent.id)\n```\n**Issue 3: Fallback metadata not tracking adhoc agent issues**\nLocation: packages/soar/src/aurora_soar/phases/collect.py:416-421\nThe code tracks when agents use fallback but doesn't distinguish adhoc agents.\n**Recommendation**: Track adhoc failures separately:\n```python\nif spawn_result.fallback:\nif is_spawn:\nexecution_metadata.setdefault(\"adhoc_fallbacks\", []).append(agent.id)\nfallback_agents.append(agent.id)\n```\n## Debugging Commands\nCheck current failures:\n```bash\n# View early termination details\ncat .aurora/logs/soar-*.log | jq '.phases.phase5_collect.recovery_metrics.early_termination_details'\n# Check circuit breaker blocks\ncat .aurora/logs/soar-*.log | jq '.phases.phase5_collect.execution_metadata.circuit_blocked'\n# Monitor real-time health checks\naur soar \"query\" --verbose 2>&1 | grep -i \"health check\\|early termination\\|stalled\"\n```\n## Immediate Action\n1. **Add configuration** (easiest, no code changes):\nCreate/update `.aurora/config.json` with lenient thresholds above\n2. **Test with verbose logging**:\n```bash\naur soar \"your query\" --verbose 2>&1 | tee soar-debug.log\n```\n3. **Review circuit breaker state**:\nThe adhoc agents may be getting blocked after initial failures. Check logs for \"Circuit breaker open\" messages.",
      "confidence": 0.9,
      "traceability": [],
      "metadata": {
        "retry_count": 0,
        "verification_score": 0.9,
        "coherence": 0.9,
        "completeness": 0.85,
        "factuality": 0.95,
        "subgoals_completed": 0,
        "subgoals_partial": 0,
        "subgoals_failed": 0,
        "total_files_modified": 0,
        "user_interactions_count": 0
      },
      "timing": {
        "duration_ms": 73655,
        "started_at": 1768485218.6098783,
        "completed_at": 1768485292.2654026,
        "input_tokens": 45,
        "output_tokens": 1159
      },
      "_timing_ms": 0,
      "_error": null
    },
    "phase7_record": {
      "cached": true,
      "reasoning_chunk_id": "summary_24f265cd7af74e90",
      "pattern_marked": true,
      "activation_update": 0.2,
      "timing": {
        "duration_ms": 4,
        "started_at": 1768485292.2827709,
        "completed_at": 1768485292.287624
      },
      "_timing_ms": 0,
      "_error": null
    },
    "phase8_respond": {
      "verbosity": "normal",
      "formatted": true
    }
  },
  "timestamp": 1768485292.2979531
}
```
