{
  "prompt": "Here are some examples:\n\nQuery: What does the calculate_total function in utils.py do?\n\nDecomposition: {\n  \"goal\": \"Understand the calculate_total function's purpose and behavior\",\n  \"subgoals\": [\n    {\n      \"description\": \"Locate and read calculate_total function in utils.py\",\n      \"suggested_agent\": \"code-analyzer\",\n      \"is_critical\": true,\n      \"depends_on\": []\n    }\n  ],\n  \"execution_order\": [\n    {\n      \"phase\": 1,\n      \"parallelizable\": [\n        0\n      ],\n      \"sequential\": []\n    }\n  ],\n  \"expected_tools\": [\n    \"code_reader\",\n    \"ast_parser\"\n  ]\n}\n\nQuery: Add a new feature to validate email addresses in the user registration flow\n\nDecomposition: {\n  \"goal\": \"Implement email validation in user registration with proper error handling\",\n  \"subgoals\": [\n    {\n      \"description\": \"Analyze existing user registration flow and identify integration points\",\n      \"suggested_agent\": \"code-analyzer\",\n      \"is_critical\": true,\n      \"depends_on\": []\n    },\n    {\n      \"description\": \"Create email validation function with regex pattern and domain checks\",\n      \"suggested_agent\": \"code-analyzer\",\n      \"is_critical\": true,\n      \"depends_on\": [\n        0\n      ]\n    },\n    {\n      \"description\": \"Write unit tests for email validation function\",\n      \"suggested_agent\": \"test-runner\",\n      \"is_critical\": true,\n      \"depends_on\": [\n        1\n      ]\n    },\n    {\n      \"description\": \"Integrate validation into registration form with user-friendly error messages\",\n      \"suggested_agent\": \"refactoring-engine\",\n      \"is_critical\": true,\n      \"depends_on\": [\n        1,\n        2\n      ]\n    }\n  ],\n  \"execution_order\": [\n    {\n      \"phase\": 1,\n      \"parallelizable\": [\n        0\n      ],\n      \"sequential\": []\n    },\n    {\n      \"phase\": 2,\n      \"parallelizable\": [\n        1\n      ],\n      \"sequential\": []\n    },\n    {\n      \"phase\": 3,\n      \"parallelizable\": [\n        2\n      ],\n      \"sequential\": []\n    },\n    {\n      \"phase\": 4,\n      \"parallelizable\": [\n        3\n      ],\n      \"sequential\": []\n    }\n  ],\n  \"expected_tools\": [\n    \"code_reader\",\n    \"code_writer\",\n    \"test_runner\",\n    \"file_editor\"\n  ]\n}\n\n---\n\nQuery: Test query\n\nRelevant Context Summary:\nNo indexed context available. Using LLM general knowledge.\n\nAvailable Agents: 1-create-prd, 2-generate-tasks, 3-process-task-list, business-analyst, context-initializer, full-stack-dev, holistic-architect, master, orchestrator, product-manager, product-owner, qa-test-architect, scrum-master, test-soar, ux-expert\n\nDecompose this query into actionable subgoals in JSON format.",
  "system": "You are a query decomposition expert for a code reasoning system.\n\nYour task is to break down complex queries into concrete, actionable subgoals that can be\nexecuted by specialized agents.\n\nFor each subgoal, specify:\n1. A clear, specific goal statement\n2. The suggested agent to execute it (from available agents, or 'llm' as fallback)\n3. Whether the subgoal is critical to the overall query\n4. Dependencies on other subgoals (by index)\n\nOrganize subgoals into an execution order, marking which can run in parallel.\n\nAvailable agents: 1-create-prd, 2-generate-tasks, 3-process-task-list, business-analyst, context-initializer, full-stack-dev, holistic-architect, master, orchestrator, product-manager, product-owner, qa-test-architect, scrum-master, test-soar, ux-expert\n\nYou MUST respond with valid JSON only. Use this exact schema:\n{\n  \"goal\": \"High-level goal summarizing what we're trying to achieve\",\n  \"subgoals\": [\n    {\n      \"description\": \"Specific subgoal description\",\n      \"suggested_agent\": \"agent-name\",\n      \"is_critical\": true/false,\n      \"depends_on\": [0, 1]  // indices of prerequisite subgoals\n    }\n  ],\n  \"execution_order\": [\n    {\n      \"phase\": 1,\n      \"parallelizable\": [0, 1],  // subgoal indices that can run in parallel\n      \"sequential\": [2]  // subgoals that must run after this phase\n    }\n  ],\n  \"expected_tools\": [\"list\", \"of\", \"expected\", \"tool\", \"types\"]\n}\n\nYou MUST respond with valid JSON only. Do not include markdown code blocks, explanations, or any text outside the JSON object.",
  "phase": "unknown",
  "tool": "claude"
}