{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://aurora.dev/schemas/agents.json",
  "title": "Aurora Planning System - Plan Metadata Schema",
  "description": "JSON schema for agents.json file in Aurora planning system. Defines the structure for plan metadata including subgoals, dependencies, and agent assignments.",
  "type": "object",
  "required": ["plan_id", "goal", "status", "created_at", "updated_at", "subgoals"],
  "properties": {
    "plan_id": {
      "type": "string",
      "pattern": "^\\d{4}-[a-z0-9-]+$",
      "description": "Unique plan identifier (format: NNNN-slug, e.g., 0001-implement-oauth2-authentication)",
      "examples": ["0001-oauth-auth", "0042-user-dashboard"]
    },
    "goal": {
      "type": "string",
      "minLength": 10,
      "maxLength": 500,
      "description": "Original goal statement describing what needs to be achieved"
    },
    "status": {
      "type": "string",
      "enum": ["active", "completed", "archived", "failed"],
      "description": "Current plan status",
      "default": "active"
    },
    "complexity": {
      "type": "string",
      "enum": ["simple", "moderate", "complex"],
      "description": "Plan complexity assessment based on number of subgoals and dependencies",
      "default": "moderate"
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of plan creation (UTC)"
    },
    "updated_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of last modification (UTC)"
    },
    "archived_at": {
      "type": ["string", "null"],
      "format": "date-time",
      "description": "ISO 8601 timestamp of archival (null if active)"
    },
    "subgoals": {
      "type": "array",
      "minItems": 1,
      "maxItems": 20,
      "items": {
        "type": "object",
        "required": ["id", "title", "description", "agent_id", "status", "dependencies"],
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^sg-\\d+$",
            "description": "Subgoal identifier (format: sg-N, e.g., sg-1, sg-2)",
            "examples": ["sg-1", "sg-2", "sg-10"]
          },
          "title": {
            "type": "string",
            "minLength": 5,
            "maxLength": 100,
            "description": "Brief subgoal title (imperative form)"
          },
          "description": {
            "type": "string",
            "minLength": 10,
            "maxLength": 500,
            "description": "Detailed subgoal description explaining what needs to be done"
          },
          "agent_id": {
            "type": "string",
            "pattern": "^@[a-z0-9-]+$",
            "description": "Recommended agent for this subgoal (format: @agent-name)",
            "examples": ["@full-stack-dev", "@qa-test-architect", "@holistic-architect"]
          },
          "status": {
            "type": "string",
            "enum": ["pending", "in_progress", "completed", "blocked"],
            "description": "Subgoal completion status",
            "default": "pending"
          },
          "dependencies": {
            "type": "array",
            "items": {
              "type": "string",
              "pattern": "^sg-\\d+$"
            },
            "description": "List of subgoal IDs that must complete before this subgoal can start",
            "default": []
          }
        },
        "additionalProperties": false
      },
      "description": "Ordered list of subgoals decomposing the main goal"
    },
    "tags": {
      "type": "array",
      "items": {
        "type": "string",
        "pattern": "^[a-z0-9-]+$"
      },
      "description": "Optional tags for categorization and search",
      "default": []
    },
    "metadata": {
      "type": "object",
      "properties": {
        "generator": {
          "type": "string",
          "description": "Tool that generated this plan",
          "default": "Aurora Planning System"
        },
        "version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+$",
          "description": "Aurora Planning System version",
          "examples": ["0.1.0", "1.0.0"]
        },
        "plan_format": {
          "type": "string",
          "description": "Plan file structure format",
          "enum": ["eight-file-workflow"],
          "default": "eight-file-workflow"
        }
      },
      "description": "Additional metadata about plan generation"
    }
  },
  "additionalProperties": false
}
