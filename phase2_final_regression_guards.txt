============================= test session starts ==============================
platform linux -- Python 3.10.12, pytest-8.4.2, pluggy-1.6.0 -- /usr/bin/python3
cachedir: .pytest_cache
benchmark: 5.2.3 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: /home/hamr/PycharmProjects/aurora
configfile: pytest.ini
plugins: cov-7.0.0, asyncio-1.3.0, anyio-4.12.0, benchmark-5.2.3, typeguard-4.4.4
asyncio: mode=strict, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 4 items

tests/performance/test_soar_startup_performance.py::TestRegressionGuards::test_guard_import_time FAILED [ 25%]
tests/performance/test_soar_startup_performance.py::TestRegressionGuards::test_guard_config_time PASSED [ 50%]
tests/performance/test_soar_startup_performance.py::TestRegressionGuards::test_guard_store_init_time PASSED [ 75%]
tests/performance/test_soar_startup_performance.py::TestRegressionGuards::test_guard_registry_init_time PASSED [100%]

=================================== FAILURES ===================================
_________________ TestRegressionGuards.test_guard_import_time __________________

self = <tests.performance.test_soar_startup_performance.TestRegressionGuards object at 0x78dda6c96170>

    def test_guard_import_time(self):
        """REGRESSION GUARD: Critical imports must complete in <2s."""
        import sys

        modules_to_clear = [
            k
            for k in list(sys.modules.keys())
            if "aurora_soar" in k or "aurora_cli.commands.soar" in k
        ]
        for mod in modules_to_clear:
            del sys.modules[mod]

        start = time.time()
        from aurora_cli.commands.soar import soar_command  # noqa: F401

        elapsed = time.time() - start

>       assert elapsed < self.MAX_IMPORT_TIME, (
            f"REGRESSION: Import time {elapsed:.3f}s exceeds {self.MAX_IMPORT_TIME}s. "
            "Check for new heavy imports at module level."
        )
E       AssertionError: REGRESSION: Import time 3.427s exceeds 2.0s. Check for new heavy imports at module level.
E       assert 3.4270455837249756 < 2.0
E        +  where 2.0 = <tests.performance.test_soar_startup_performance.TestRegressionGuards object at 0x78dda6c96170>.MAX_IMPORT_TIME

tests/performance/test_soar_startup_performance.py:401: AssertionError
=============================== warnings summary ===============================
tests/performance/test_soar_startup_performance.py::TestRegressionGuards::test_guard_registry_init_time
  /home/hamr/PycharmProjects/aurora/tests/performance/test_soar_startup_performance.py:441: DeprecationWarning: AgentRegistry is deprecated. Use aurora_cli.agent_discovery.ManifestManager instead.
    AgentRegistry()

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.10.12-final-0 _______________

Name                                                                  Stmts   Miss   Cover   Missing
----------------------------------------------------------------------------------------------------
packages/cli/src/aurora_cli/agent_discovery/manifest.py                 110     91  17.27%   72-73, 98-161, 182-212, 231-254, 277-309, 341-354, 379-390
packages/cli/src/aurora_cli/agent_discovery/models.py                    97     44  54.64%   140-152, 169-200, 217-224, 300, 304-308, 320, 332, 346-352, 361, 380-387
packages/cli/src/aurora_cli/agent_discovery/parser.py                    90     73  18.89%   43-53, 67-73, 86-97, 147-185, 214-252, 273-282
packages/cli/src/aurora_cli/agent_discovery/scanner.py                   57     42  26.32%   30-32, 72-75, 85, 104-115, 140-163, 182-195, 212-218
packages/cli/src/aurora_cli/commands/goals.py                           192    152  20.83%   71-90, 125-140, 152-154, 163-175, 197, 224-292, 304-322, 334-359, 466-532, 542-545, 563-565, 574-579
packages/cli/src/aurora_cli/commands/headless.py                        562    511   9.07%   25-34, 42-52, 60-72, 105, 139-184, 206-217, 237-251, 263, 275-291, 324-341, 556-716, 747-894, 917-1012, 1021-1088, 1093-1132, 1137-1155, 1160-1171, 1176-1181, 1199-1245, 1267-1369
packages/cli/src/aurora_cli/commands/init.py                            488    463   5.12%   39, 60-80, 94-103, 127-185, 208-280, 313-454, 475-542, 552-555, 575-675, 726-1023
packages/cli/src/aurora_cli/commands/init_helpers.py                    395    360   8.86%   35-36, 48-57, 70-71, 84-109, 122-123, 140-141, 161-205, 224-237, 259-333, 345-396, 411-421, 438-560, 576-662, 685-724, 743-772, 787-864, 881-906, 921-939, 955-963, 976-977, 1005-1054, 1067-1069, 1093-1141
packages/cli/src/aurora_cli/commands/memory.py                          649    578  10.94%   47-60, 89-91, 95-99, 129-245, 263-313, 381-395, 494-617, 646-666, 693-849, 869-1016, 1026-1042, 1055-1062, 1076-1078, 1102-1115, 1152-1298, 1327-1370, 1383-1417, 1443-1449, 1478-1508, 1518-1526, 1536-1555, 1568-1598
packages/cli/src/aurora_cli/commands/plan.py                            201    153  23.88%   159-231, 271-285, 334-392, 440-490, 521-546
packages/cli/src/aurora_cli/commands/soar.py                            284    250  11.97%   88-111, 126-187, 209-224, 234-237, 251-255, 266-386, 400-411, 507-696
packages/cli/src/aurora_cli/commands/spawn.py                           142    114  19.72%   137-244, 261-278, 310-355, 383-422, 439
packages/cli/src/aurora_cli/config.py                                   251    144  42.63%   34-35, 67-73, 78-81, 88, 92-97, 103, 107, 110, 114, 117-121, 125, 130-135, 138-143, 148-157, 187-189, 193-200, 216-224, 237-290, 300-301, 307-313, 318-319, 324-327, 332-333, 338-339, 368, 370, 372, 374, 378, 382, 387, 391, 398, 402, 406, 410, 414, 418, 425, 429, 433, 437, 441, 445, 449, 453, 457, 461, 465, 469, 473, 478-479, 483, 486, 489, 492, 495, 499-501
packages/cli/src/aurora_cli/configurators/agents.py                      11      3  72.73%   18, 23, 35
packages/cli/src/aurora_cli/configurators/ampcode.py                     11      3  72.73%   17, 22, 35
packages/cli/src/aurora_cli/configurators/base.py                        34     19  44.12%   38, 74, 101-104, 130-153
packages/cli/src/aurora_cli/configurators/claude.py                      14      4  71.43%   20, 25, 37, 57
packages/cli/src/aurora_cli/configurators/claude_commands.py             41     28  31.71%   29, 34, 39, 58-74, 95-120, 129
packages/cli/src/aurora_cli/configurators/droid.py                       11      3  72.73%   17, 22, 35
packages/cli/src/aurora_cli/configurators/opencode.py                    11      3  72.73%   17, 22, 35
packages/cli/src/aurora_cli/configurators/registry.py                    33     14  57.58%   23-34, 44-46, 59-60, 70-71, 81-82
packages/cli/src/aurora_cli/configurators/slash/amazon_q.py              20      7  65.00%   81, 86, 98, 110, 122, 134-141
packages/cli/src/aurora_cli/configurators/slash/antigravity.py           20      7  65.00%   39, 44, 56, 68-69, 81, 93
packages/cli/src/aurora_cli/configurators/slash/auggie.py                20      7  65.00%   69, 74, 86, 98, 110, 122-129
packages/cli/src/aurora_cli/configurators/slash/base.py                  62     43  30.65%   59, 74, 90-121, 136-146, 200, 213-214, 227-242
packages/cli/src/aurora_cli/configurators/slash/claude.py                20      7  65.00%   64, 69, 81, 93, 105, 117-124
packages/cli/src/aurora_cli/configurators/slash/cline.py                 21      8  61.90%   40, 45, 57, 74-76, 88, 100
packages/cli/src/aurora_cli/configurators/slash/codebuddy.py             20      7  65.00%   64, 69, 81, 93, 105, 117-124
packages/cli/src/aurora_cli/configurators/slash/codex.py                 62     43  30.65%   70, 75, 87-94, 109, 124, 136, 148-155, 170-172, 188-216, 231-243
packages/cli/src/aurora_cli/configurators/slash/costrict.py              20      7  65.00%   69, 74, 86, 98, 110, 122-129
packages/cli/src/aurora_cli/configurators/slash/crush.py                 20      7  65.00%   64, 69, 81, 93, 105, 117-124
packages/cli/src/aurora_cli/configurators/slash/cursor.py                20      7  65.00%   70, 75, 87, 99, 111, 123-130
packages/cli/src/aurora_cli/configurators/slash/factory.py               18      6  66.67%   70, 75, 87, 99, 113-114
packages/cli/src/aurora_cli/configurators/slash/gemini.py                17      5  70.59%   41, 46, 58, 70, 82
packages/cli/src/aurora_cli/configurators/slash/github_copilot.py        20      7  65.00%   60, 65, 77, 89, 101, 113-120
packages/cli/src/aurora_cli/configurators/slash/iflow.py                 20      7  65.00%   69, 74, 86, 98, 110, 122-129
packages/cli/src/aurora_cli/configurators/slash/kilocode.py              19      7  63.16%   30, 35, 47, 61, 73, 85-92
packages/cli/src/aurora_cli/configurators/slash/opencode.py              20      7  65.00%   76, 81, 93, 105, 117, 129-136
packages/cli/src/aurora_cli/configurators/slash/qoder.py                 20      7  65.00%   64, 69, 81, 93, 105, 117-124
packages/cli/src/aurora_cli/configurators/slash/qwen.py                  17      5  70.59%   40, 45, 57, 69, 81
packages/cli/src/aurora_cli/configurators/slash/registry.py              56     38  32.14%   22-76, 89-90, 103-105, 115-116, 126-127, 135-136, 149
packages/cli/src/aurora_cli/configurators/slash/roocode.py               21      8  61.90%   40, 45, 57, 74-76, 88, 100
packages/cli/src/aurora_cli/configurators/slash/toml_base.py             33     25  24.24%   42, 70-87, 100-104, 127-142
packages/cli/src/aurora_cli/configurators/slash/windsurf.py              20      7  65.00%   41, 46, 58, 72-73, 88, 100
packages/cli/src/aurora_cli/errors.py                                   194    149  23.20%   61-69, 83, 93, 107-177, 198-286, 309-382, 411-454, 478-536, 562-566, 602-604, 638-641, 670-788
packages/cli/src/aurora_cli/ignore_patterns.py                           46     38  17.39%   40-55, 70-81, 101-123
packages/cli/src/aurora_cli/llm/cli_pipe_client.py                      101     81  19.80%   55-63, 72-78, 88-95, 127-232, 270-287, 301, 306
packages/cli/src/aurora_cli/memory_manager.py                           697    592  15.06%   67-72, 93-97, 101-103, 107-123, 139-148, 157-160, 173-182, 198-239, 405-418, 426-434, 475-1034, 1060-1122, 1134-1171, 1185-1203, 1216-1219, 1232-1253, 1265-1278, 1287-1299, 1308-1323, 1332-1354, 1363-1373, 1393-1444, 1453-1454, 1463-1464, 1473-1485, 1494-1498, 1507-1536, 1545-1576, 1586-1594, 1611-1645, 1654-1664, 1684-1699, 1726-1784, 1796-1818
packages/cli/src/aurora_cli/planning/core.py                            670    623   7.01%   49-51, 64, 87-133, 161-225, 242-244, 257-263, 274-276, 294-306, 321-343, 356-366, 389-465, 487-564, 588-671, 691-768, 781-785, 800-808, 821-854, 879-908, 930-1007, 1020-1053, 1066, 1103-1124, 1155-1207, 1239-1409, 1449-1744, 1770-1788, 1793, 1826, 1852, 1878, 1918, 1944, 2007-2121
packages/cli/src/aurora_cli/planning/errors.py                           19      8  57.89%   93-100, 122
packages/cli/src/aurora_cli/planning/models.py                          331    199  39.88%   159-168, 185-191, 207-226, 338-346, 356-366, 379-408, 417, 430, 481-483, 493-498, 503, 558-566, 626-629, 647-653, 741-744, 758-953
packages/cli/src/aurora_cli/planning/renderer.py                         70     53  24.29%   20-22, 40-41, 54-64, 69, 85-90, 103-185, 207-257
packages/cli/src/aurora_cli/planning/results.py                          52      2  96.15%   174-175
packages/cli/src/aurora_cli/templates/agents.py                           3      1  66.67%   282
packages/cli/src/aurora_cli/templates/claude.py                           3      1  66.67%   32
packages/cli/src/aurora_cli/templates/commands.py                         9      2  77.78%   20, 30
packages/cli/src/aurora_cli/templates/project.py                          3      1  66.67%   47
packages/cli/src/aurora_cli/templates/slash_commands.py                  14      3  78.57%   301-304
packages/context-code/src/aurora_context_code/__init__.py                 8      4  50.00%   24-39
packages/context-code/src/aurora_context_code/git.py                    149    130  12.75%   58-75, 82-98, 114-157, 188-226, 259-294, 298-300, 315-326, 342-367, 407-439
packages/context-code/src/aurora_context_code/parser.py                   7      1  85.71%   39
packages/context-code/src/aurora_context_code/registry.py                66     50  24.24%   33-34, 46-53, 65, 79-85, 94, 106-110, 114-115, 137-144, 154-184
packages/core/src/aurora_core/budget/tracker.py                         156    102  34.62%   35-37, 94, 99-101, 105, 109, 151-170, 174, 178-205, 212-222, 226-248, 260, 279-280, 301-305, 328-367, 390-406, 415, 433-436, 445-448, 459-462, 466-468, 477, 486, 519-532
packages/core/src/aurora_core/chunks/base.py                             16      8  50.00%   31-34, 76-78, 82
packages/core/src/aurora_core/chunks/code_chunk.py                      100     75  25.00%   85-102, 114-130, 163-215, 236-270
packages/core/src/aurora_core/chunks/reasoning_chunk.py                  55     36  34.55%   64-76, 85, 118-142, 155-185
packages/core/src/aurora_core/exceptions.py                              40     24  40.00%   23-25, 28-30, 95-97, 127-139, 162-164, 195-198
packages/core/src/aurora_core/logging/conversation_logger.py            165    141  14.55%   22-33, 65-69, 92-123, 127-130, 144-191, 205-217, 229-243, 266-376, 385-407
packages/core/src/aurora_core/metrics/query_metrics.py                  102     70  31.37%   70-73, 77-115, 147-183, 195-300, 312-340
packages/core/src/aurora_core/paths.py                                   20     12  40.00%   37-42, 56, 66, 76, 90, 104-106, 116
packages/core/src/aurora_core/store/base.py                              17      9  47.06%   243-250, 287-288
packages/core/src/aurora_core/store/connection_pool.py                   87     74  14.94%   27-30, 55-110, 120-139, 148-168, 185-190, 200-201
packages/core/src/aurora_core/store/memory.py                           139    116  16.55%   42-47, 51-52, 59-61, 77-96, 111-112, 126-142, 158-170, 195-216, 233-259, 279-300, 325-343, 363-381, 407-437, 449-453, 457, 461
packages/core/src/aurora_core/store/migrations.py                       103     72  30.10%   48-53, 104-152, 160-168, 189-197, 209-210, 225-256, 271-286, 306-318, 332
packages/core/src/aurora_core/store/schema.py                            19      2  89.47%   123, 133
packages/core/src/aurora_core/store/sqlite.py                           331    282  14.80%   90-109, 123-138, 156-202, 216-229, 248-262, 279-327, 342-363, 378-418, 435-453, 471-487, 502-508, 531-582, 601-621, 646-669, 689-731, 755-836, 859-889, 915-943, 967-1000, 1010-1014, 1031-1059, 1081-1098
packages/implement/src/implement/executor.py                             50     30  40.00%   52, 65-92, 106, 123-149, 167-174, 184-202
packages/implement/src/implement/models.py                               14      2  85.71%   40, 63
packages/implement/src/implement/parser.py                               32     23  28.12%   51-90
packages/reasoning/src/aurora_reasoning/llm_client.py                   175    131  25.14%   134-160, 188-206, 212-215, 251-278, 309-326, 341, 346, 374-392, 396-399, 435-467, 498-519, 534, 539, 564-576, 580-583, 619-662, 693-710, 725, 730
packages/reasoning/src/aurora_reasoning/prompts/__init__.py              23     16  30.43%   25-26, 68-76, 91-100
packages/reasoning/src/aurora_reasoning/prompts/verify_synthesis.py      20     11  45.00%   16, 20, 52-73, 77
packages/reasoning/src/aurora_reasoning/synthesize.py                   129    113  12.40%   42-47, 51, 61, 101-217, 247-293, 298, 324-345, 361-395, 413-421, 438-452
packages/soar/src/aurora_soar/agent_registry.py                         108     72  33.33%   54-61, 105-109, 121, 130, 142, 154, 170, 182-206, 214-219, 229-235, 244-276, 283-292, 301, 320-324
packages/soar/src/aurora_soar/discovery_adapter.py                       37     24  35.14%   37, 53-57, 82-88, 120-136, 155-164, 178
packages/soar/src/aurora_soar/orchestrator.py                           625    581   7.04%   112-151, 158-206, 215-219, 231-235, 244-248, 266-272, 319-656, 665-671, 681-685, 689-711, 731-749, 753-774, 792-823, 848-953, 966-989, 1014-1029, 1044-1083, 1102-1238, 1257-1283, 1302-1329, 1348-1386, 1399-1422, 1443-1460, 1480-1535, 1594-1636, 1662-1683, 1696-1756, 1775-1828, 1849-1875, 1887-1962
packages/soar/src/aurora_soar/phases/assess.py                          372    318  14.52%   57, 66, 339, 351-432, 455-519, 523-568, 572-667, 671-708, 712-744, 748-785, 789-812, 816-839, 843-878, 884-910, 970-989, 1020-1078, 1118-1125
packages/soar/src/aurora_soar/phases/collect.py                         309    280   9.39%   45-91, 96-102, 127-160, 189-196, 200, 230-233, 237, 281-525, 553-629, 652-679, 711-792, 825-827, 867-929, 954-983, 996-1003
packages/soar/src/aurora_soar/phases/decompose.py                       103     90  12.62%   38-41, 45, 68-69, 107-153, 174-194, 210-278, 287
packages/soar/src/aurora_soar/phases/record.py                           71     46  35.21%   56, 87-91, 95, 123-181, 217-302
packages/soar/src/aurora_soar/phases/respond.py                         170    150  11.76%   26-37, 63-64, 68, 90-118, 134-137, 156-214, 233-344, 357-369
packages/soar/src/aurora_soar/phases/retrieve.py                         63     53  15.87%   59-92, 117-208
packages/soar/src/aurora_soar/phases/synthesize.py                       53     40  24.53%   45-49, 53, 64, 100-180
packages/soar/src/aurora_soar/phases/verify.py                           87     82   5.75%   46-148, 164-221
packages/spawner/src/aurora_spawner/circuit_breaker.py                  160    128  20.00%   90-103, 113-115, 132-137, 146-147, 166-249, 258-266, 278-279, 295-325, 334-336, 340-341, 353-368, 380-399, 421, 439-441
packages/spawner/src/aurora_spawner/early_detection.py                  165    120  27.27%   95-99, 103-113, 120-135, 149-160, 176-190, 199-200, 212-220, 224-234, 238-248, 258-278, 301-323, 334-355, 370-372, 388-398
packages/spawner/src/aurora_spawner/heartbeat.py                        112     71  36.61%   42, 46, 71-78, 96-123, 132-133, 142-143, 152-153, 162-165, 174-177, 189-199, 227-231, 240-259, 271-286, 299, 313
packages/spawner/src/aurora_spawner/models.py                            25      2  92.00%   19, 45
packages/spawner/src/aurora_spawner/observability.py                    330    238  27.88%   121-135, 139-152, 156-162, 179-194, 210-220, 229-231, 235-241, 245-255, 268-304, 331-371, 389-396, 412-429, 440-468, 490-570, 581-596, 615-619, 637, 655-657, 666, 675-688, 712-721, 730-763, 793-795, 812-815, 831-925
packages/spawner/src/aurora_spawner/recovery.py                         354    193  45.48%   103-116, 131, 135, 147-161, 165-167, 171-174, 183-187, 192, 197, 202-210, 214, 271-273, 278-282, 301-311, 323, 336, 345, 355, 364-374, 386, 465-474, 486, 501-503, 549-569, 581-590, 602-611, 623-630, 634, 658-664, 674-676, 682-683, 748-755, 767, 781-798, 823-832, 837, 850, 863, 872, 881, 905-918, 930-931, 943, 947, 981-993, 1033-1047, 1059-1061, 1078, 1104-1106, 1111-1114, 1118
packages/spawner/src/aurora_spawner/spawner.py                          635    616   2.99%   66-486, 513-551, 602-671, 714-857, 878-908, 961-1271, 1305-1554
packages/spawner/src/aurora_spawner/timeout_policy.py                   135     62  54.07%   76-101, 114-127, 162-169, 183-194, 207-208, 261-277, 307, 334, 361, 384, 410, 430, 465-479, 483
----------------------------------------------------------------------------------------------------
TOTAL                                                                 12531   9784  21.92%

21 files skipped due to complete coverage.
Coverage HTML written to dir htmlcov
Coverage XML written to file coverage.xml
=========================== short test summary info ============================
FAILED tests/performance/test_soar_startup_performance.py::TestRegressionGuards::test_guard_import_time - AssertionError: REGRESSION: Import time 3.427s exceeds 2.0s. Check for new heavy imports at module level.
assert 3.4270455837249756 < 2.0
 +  where 2.0 = <tests.performance.test_soar_startup_performance.TestRegressionGuards object at 0x78dda6c96170>.MAX_IMPORT_TIME
=================== 1 failed, 3 passed, 1 warning in 34.50s ====================
